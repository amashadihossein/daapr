<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="daapr">
<title>daapr: New project workflow • daapr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="daapr: New project workflow">
<meta property="og:description" content="daapr">
<meta property="og:image" content="https://amashadihossein.github.io/daapr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">daapr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9005</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/daapr.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/min_wrkfl.html">A minimalist example</a>
    <a class="dropdown-item" href="../articles/input_data_update.html">Update input data</a>
    <a class="dropdown-item" href="../articles/dp_update.html">Update build logic</a>
    <a class="dropdown-item" href="../articles/dp_merge.html">Combine two data products</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/amashadihossein/daapr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>daapr: New project workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/amashadihossein/daapr/blob/HEAD/vignettes/daapr.Rmd" class="external-link"><code>vignettes/daapr.Rmd</code></a></small>
      <div class="d-none name"><code>daapr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="step-1-initialize-the-project">Step 1: Initialize the project<a class="anchor" aria-label="anchor" href="#step-1-initialize-the-project"></a>
</h2>
<p>For a new project, start by initializing the project using
<code><a href="https://rdrr.io/pkg/dpbuild/man/dp_init.html" class="external-link">dpbuild::dp_init</a></code>, which does the following:</p>
<ol style="list-style-type: decimal">
<li>sets up the folder structure</li>
<li>sets up git and switch to specified <code>branch_name</code>
</li>
<li>sets up <code>renv</code> to capture package dependencies</li>
<li>sets up daap configuration yaml file
<code>daap_config.yaml</code>
</li>
</ol>
<p>An example would be as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">daapr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">board_params_set_dried</span>  <span class="op">&lt;-</span> <span class="fu">fn_dry</span><span class="op">(</span><span class="fu">board_params_set_s3</span><span class="op">(</span>board_alias <span class="op">=</span> <span class="st">"cars_board"</span>,</span>
<span>                                                      bucket_name <span class="op">=</span> <span class="st">"daap_bucket"</span>,</span>
<span>                                                      region <span class="op">=</span> <span class="st">"us-west-1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Dry function call to setting credentials</span></span>
<span><span class="va">creds_set_dried</span> <span class="op">&lt;-</span> <span class="fu">fn_dry</span><span class="op">(</span><span class="fu">creds_set_aws</span><span class="op">(</span>key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"AWS_KEY"</span><span class="op">)</span>, secret <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"AWS_SECRET"</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize dp repo</span></span>
<span><span class="va">dp_repo</span> <span class="op">&lt;-</span> <span class="fu">dp_init</span><span class="op">(</span>project_path <span class="op">=</span> <span class="st">"dp_test1"</span>,</span>
<span>                   project_description <span class="op">=</span> <span class="st">"Test data product"</span>,</span>
<span>                   branch_name <span class="op">=</span> <span class="st">"us001"</span>,</span>
<span>                   branch_description <span class="op">=</span> <span class="st">"User story 1"</span>,</span>
<span>                   readme_general_note <span class="op">=</span> <span class="st">"This data object is generated for testing purposes"</span>,</span>
<span>                   board_params_set_dried <span class="op">=</span> <span class="va">board_params_set_dried</span>,</span>
<span>                   creds_set_dried <span class="op">=</span> <span class="va">creds_set_dried</span>,</span>
<span>                   github_repo_url <span class="op">=</span> <span class="st">"&lt;GIT PATH/dp_test1.git&gt;"</span><span class="op">)</span></span></code></pre></div>
<p><strong>NOTE:</strong> <code>dp_init</code> builds the yaml config
file, <code>daap_config.yaml</code>, with all the configurations
specified. Configuration includes key:value pairs as well as instruction
for function calls. In the above example, two instructions for two
function calls are provided. These function call instructions can be
thought of as “dried” functions which could be “hydrated” later when
executed:</p>
<ul>
<li><code>board_params_set_s3(board_alias = "cars_board", bucket_name = "daap_bucket",region = "us-west-1")</code></li>
<li><code>creds_set_aws(key = Sys.getenv("AWS_KEY"), secret = Sys.getenv("AWS_SECRET") )</code></li>
</ul>
<p>Note, that the 2nd function call relies on “AWS_KEY” and “AWS_SECRET”
to be available in the environment when the function is beign
hydrated</p>
</div>
<div class="section level2">
<h2 id="step-2-add-starter-script">Step 2: Add starter script<a class="anchor" aria-label="anchor" href="#step-2-add-starter-script"></a>
</h2>
<p>This step is optional, but highly recommended. The starter code
includes:</p>
<ol style="list-style-type: decimal">
<li>
<code>dp_journal.RMD</code>: A dev journal which will help both
guide one through and document the steps in building the data
product</li>
<li>
<code>dp_make.R</code>: The main workflow management script the
execution of which should build the data product</li>
<li>
<code>R/dp_structure.R</code>: Starter code that will help with
structuring the data product</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dpbuild</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dpbuild/man/dpcode_add.html" class="external-link">dpcode_add</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">dp_repo</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-3-data-prep">Step 3: Data prep<a class="anchor" aria-label="anchor" href="#step-3-data-prep"></a>
</h2>
<p><strong>Goal:</strong>: This involves following the steps in the dev
journal up until <code>source("dp_make.R")</code> step. The goal of this
step is to sync the right subset (or all) of the input data into remote
and capture the relevant metadata.</p>
<p>For convenience, the directory is switched to project directory just
built</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">dp_repo</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-4-derive-new-features-as-needed">Step 4: Derive new features as needed<a class="anchor" aria-label="anchor" href="#step-4-derive-new-features-as-needed"></a>
</h2>
<p>This is where the main logic of building a data product per user
story is implemented as functions defined within the <code>/R</code>
sub-directory of the project, as well as integration of these functions
within <code>dp_make.R</code> workflow.</p>
</div>
<div class="section level2">
<h2 id="step-5-execute-dp_make-r">Step 5: Execute <code>dp_make.R</code><a class="anchor" aria-label="anchor" href="#step-5-execute-dp_make-r"></a>
</h2>
<p>Once satisfied with changes needed to derived features, execute the
workflow plan (this is included <code>dp_journal.RMD</code>)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"dp_make.R"</span><span class="op">)</span></span></code></pre></div>
<p>If data testing has been implemented, the test results can be
evaluated here and modifications to the code be made as needed.</p>
</div>
<div class="section level2">
<h2 id="step-6-commit">Step 6: commit<a class="anchor" aria-label="anchor" href="#step-6-commit"></a>
</h2>
<p>Once data product made meets the expectation, run
<code>dp_commit</code> providing the commit message. This will complete
one development cycle, making the data product and code ready for
deployment.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dpbuild</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dpbuild/man/dp_commit.html" class="external-link">dp_commit</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="st">"."</span>, commit_description <span class="op">=</span> <span class="st">"First dp build: only input data"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="step-7-push-and-deploy">Step 7: Push and deploy<a class="anchor" aria-label="anchor" href="#step-7-push-and-deploy"></a>
</h2>
<p>Push the code to GitHub repo.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dp_push</span><span class="op">(</span>project_path <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>If CI/CD is set up, the build process should pick up the
deployment from here. Specifically, remote server will clone the code,
build the data product and deploy it to the remote location as specified
by the configuration set up during the initialization.</p></li>
<li><p>In the absence of CI/CD, while GitHub push can be skipped, avoid
doing so. First push the code to the repo and then run
<code>dpdeploy::dp_deploy(&lt;project path&gt;)</code> to deploy the
code and metadata representing the data.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Afshin Mashadi-Hossein.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
